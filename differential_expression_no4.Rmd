---
title: "Differential expression no well 4"
author: "Maddie Lombardo"
date: "1/14/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(annotables)
library(PCAtools)
library(gprofiler2)
```

reading the functions in that i'll use
```{r reading the functions in}
source(here::here('run_standard_deseq.R'))
source(here::here('make_volcano_plot.R'))
```

reading in the files
```{r read in files}
feature_counts_file_path <- file.path(here::here("data","feature_counts_bdnf_No4"))
```

running a deseq 1hr
```{r deseq2 1h}
one_hour_dds <- run_standard_deseq(feature_counts_file_path, base_grep = "CONTROL",
                              contrast_grep = "BDNF", 
                              grep_pattern = "1hr",
                              baseName = "control",
                              contrastName = 'BDNF')
```

make a volcano plot 1hr
```{r volcano plot 1h}
one_hour_volcano <- make_volcano_plot(one_hour_dds$results_table)
```

deseq 2hr
```{r deseq 2h}
two_hour_dds <- run_standard_deseq(feature_counts_file_path, base_grep = "CONTROL",
                              contrast_grep = "BDNF", 
                              grep_pattern = "2hr",
                              baseName = "control",
                              contrastName = 'BDNF')
```

volcano 2hr
```{r volcano 2h}
two_hr_volcano <- make_volcano_plot(two_hour_dds$results_table)
```

deseq 6h
```{r deseq 6h}
six_hr_dds <- run_standard_deseq(feature_counts_file_path, base_grep = "CONTROL",
                              contrast_grep = "BDNF", 
                              grep_pattern = "6hr",
                              baseName = "control",
                              contrastName = 'BDNF')
```

volcano 6h
```{r volcano 6h}
six_hr_volcano <- make_volcano_plot(six_hr_dds$results_table)
```

now we are going to use the deseq data to do gene ontology
hour 1
```{r GO 1hr}
results_1hr <- one_hour_dds$results_table

results_sig_1hr <- subset(results_1hr, padj < 0.05)

up_1hr = subset(results_sig_1hr, log2FoldChange > 0)

down_1hr = subset(results_sig_1hr, log2FoldChange < 0)

gp_up_1hr = gost(row.names(up_1hr), organism = "hsapiens")
gp_down_1hr = gost(row.names(down_1hr), organism = "hsapiens") 
```

GO hr 2
```{r go 2h}
results_2hr <- two_hour_dds$results_table

results_sig_2hr <- subset(results_2hr, padj < 0.05)

up_2hr = subset(results_sig_2hr, log2FoldChange > 0)

down_2hr = subset(results_sig_2hr, log2FoldChange < 0)

gp_up_2hr = gost(row.names(up_2hr), organism = "hsapiens")
gp_down_2hr = gost(row.names(down_2hr), organism = "hsapiens")
```

go 6h
```{r go 6h}
results_6hr <- six_hour_dds$results_table

results_sig_6hr <- subset(results_6hr, padj < 0.05)

up_6hr = subset(results_sig_6hr, log2FoldChange > 0)

down_6hr = subset(results_sig_6hr, log2FoldChange < 0)

gp_up_6hr = gost(row.names(up_6hr), organism = "hsapiens")
gp_down_6hr = gost(row.names(down_6hr), organism = "hsapiens")
```
